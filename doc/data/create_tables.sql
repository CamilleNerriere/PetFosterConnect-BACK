BEGIN;
DROP TABLE IF EXISTS "animal",
"user",
"request",
"animal_has_user";
CREATE TABLE "animal" (
  "id" INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
  "name" TEXT NOT NULL,
  "gender" TEXT NOT NULL,
  "race" TEXT,
  "species" TEXT NOT NULL,
  "age" INTEGER NOT NULL,
  "size" TEXT NOT NULL,
  "description" TEXT NOT NULL,
  "url_image" TEXT UNIQUE,
  "availability" BOOLEAN NOT NULL,
  "created_at" TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
CREATE TABLE "user" (
  "id" INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
  "firstname" TEXT,
  "lastname" TEXT,
  "name" TEXT,
  "email" TEXT UNIQUE NOT NULL,
  "password" TEXT NOT NULL,
  "adress" TEXT NOT NULL,
  "zip_code" TEXT NOT NULL,
  "city" TEXT NOT NULL,
  "department" TEXT NOT NULL,
  "phone_number" TEXT NOT NULL,
  "description" TEXT,
  "url_image" TEXT UNIQUE,
  "role" TEXT NOT NULL,
  "created_at" TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
CREATE TABLE "request" (
  "id" INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
  "status" TEXT NOT NULL,
  "user_id" INTEGER NOT NULL,
  "animal_id" INTEGER NOT NULL,
  "created_at" TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
CREATE TABLE "animal_has_user" (
  "id" INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
  "user_id" INTEGER NOT NULL,
  "animal_id" INTEGER NOT NULL,
  "created_at" TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
ALTER TABLE "request"
ADD FOREIGN KEY ("user_id") REFERENCES "user" ("id") ON DELETE
SET NULL;
ALTER TABLE "request"
ADD FOREIGN KEY ("animal_id") REFERENCES "animal" ("id") ON DELETE
SET NULL;
ALTER TABLE "animal_has_user"
ADD FOREIGN KEY ("animal_id") REFERENCES "animal" ("id") ON DELETE CASCADE;
ALTER TABLE "animal_has_user"
ADD FOREIGN KEY ("user_id") REFERENCES "user" ("id") ON DELETE CASCADE;
COMMIT;